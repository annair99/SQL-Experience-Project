Anushka Nair:1601222

set echo on;
set linesize 200;
set pagesize 1000;
set heading on;

--1
SELECT * FROM pilots ORDER BY PIL_FLIGHT_PAY,PIL_PILOTNAME

--2
SELECT PIL_PILOTNAME,PIL_CITY,PIL_FLIGHT_PAY 
FROM pilots 
WHERE (PIL_CITY = 'HOUSTON' OR PIL_CITY = 'PHOENIX') AND PIL_FLIGHT_PAY>1500

--3
SELECT PAS_NAME, PAS_CONFIRM_NO, TIC_FLIGHT_NO, TIC_FLIGHT_DATE 
FROM PASSENGER
JOIN TICKET ON (PASSENGER.PAS_ITINERARY_NO = TICKET.TIC_ITINERARY_NO)
WHERE passenger.pas_confirm_no IS NOT NULL;
ORDER BY PASSENGER.PAS_NAME

--4
SELECT * FROM EQUIP_TYPE
WHERE (EQ_FUEL_CAPACITY>2500 OR ( EQ_FUEL_CAPACITY <2500 AND EQ_MILES_PER_GAL>4))

--5
SELECT FL_ORIG, COUNT(*) AS "NUMBER OF ORIGINATING FLIGHTS" 
FROM flight GROUP BY FL_ORIG;

--6
SELECT air_location, max(fl_fare) AS "Maximum_Fare"
FROM flight
JOIN airport ON airport.air_code = flight.fl_orig
WHERE fl_fare>100
GROUP BY air_location;

--7
SELECT * FROM EQUIP_TYPE WHERE EQ_EQUIP_TYPE LIKE 'BOE%';

--8
SELECT AIR_CODE, AIR_LOCATION, AIR_ELEVATION FROM airport
WHERE AIR_HUB_AIRLINE IS NULL;

--9
SELECT DISTINCT P1.PIL_PILOT_ID AS "Pilot ID" 
FROM pilots P1
JOIN pilots P2 
ON p1.PIL_PILOT_ID<>P2.PIL_PILOT_ID
JOIN departures
ON DEP_PILOT_ID=P1.PIL_PILOT_ID
ORDER BY P1.PIL_PILOT_ID

--10
SELECT FL_FLIGHT_NO, FL_ORIG, FL_DEST, FL_DISTANCE, FL_FARE, (FL_DISTANCE/FL_FARE) AS "Miles Flown Per Dollar" FROM  flight;

--11
SELECT AIR_LOCATION, COUNT(FL_ORIG) AS "Number of Originating flights" 
FROM flight 
JOIN airport ON (flight.FL_ORIG = airport.AIR_CODE)
GROUP BY AIR_LOCATION;

--12
SELECT PIL_STATE, MAX(PIL_FLIGHT_PAY) AS "Maximum Pay", MIN(PIL_FLIGHT_PAY) AS "Minimum Pay", AVG(PIL_FLIGHT_PAY) AS "Average flight pay"
FROM pilots
GROUP BY PIL_STATE;

--13
SELECT PIL_PILOTNAME,MAX(DEP_DEP_DATE) AS "Most recent departure date"
FROM pilots
JOIN departures on departures.DEP_PILOT_ID=pilots.PIL_PILOT_ID 
GROUP BY PIL_PILOTNAME
ORDER BY PIL_PILOTNAME;

--14
SELECT ROUND((((MAX(PIL_BRTHDATE)- MIN(PIL_BRTHDATE))/365)),2) AS "Age difference"
FROM pilots;

--15
SELECT DISTINCT EQ_EQUIP_TYPE, MAX(EQ_FUEL_CAPACITY/EQ_MILES_PER_GAL) AS "Maximum distance flown"
FROM EQUIP_TYPE
GROUP BY EQ_EQUIP_TYPE
ORDER BY "Maximum distance flown" DESC;
